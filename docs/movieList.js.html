<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: movieList.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: movieList.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import MovieService from "./services/movie.service.js"
import getMovieImage from "./api/omdb.api.js"

const loadMovies = () => {
    /**
     * Carga las películas y las muestra en el contenedor.
     */
    const moviesContainer = document.getElementById('movies')
    const movieService = MovieService.getInstance()
    
    const reprint = () => {
        moviesContainer.innerHTML = ''
        loadMovies()
    }

    const handleVoteRate = (vote, movie) => {
        /**
         * Maneja la votación de una película.
         * @param {boolean} vote - El voto (true para upvote, false para downvote).
         * @param {Object} movie - La película a la que se le aplica el voto.
         */
        movieService.vote(vote, movie.id)
        reprint()
    }

    const displayAllInfo = (movie, show) => {
        /**
         * Muestra u oculta la información de una película.
         * @param {Object} movie - La película de la que se muestra la información.
         * @param {boolean} show - Indica si se debe mostrar la información.
         */
        const allInfoContainer = document.getElementById(`allInfo${movie.id}`)
        allInfoContainer.style = `opacity: ${show ? 1 : 0}`
    }

    const delMovie = (id) => {
        /**
         * Elimina una película de la lista.
         * @param {number} id - El ID de la película a eliminar.
         */
        movieService.removeMovie(id)
        reprint()
    }

    const createMovieElement = async(movie) => {
        /**
         * Crea un elemento DOM para una película.
         * @param {Object} movie - La película para la que se crea el elemento.
         * @returns {HTMLElement} El elemento DOM que representa la película.
         */
        const contentParent = document.createElement('div')
        contentParent.className = 'movieContentParent'

        const allInfo = document.createElement('div')
        allInfo.className = 'allInfo'
        allInfo.id = `allInfo${movie.id}`

        const nVotes = document.createElement('p')
        nVotes.textContent = `Votos: ${movie.votes.length}`
        
        const genres = document.createElement('p')
        genres.textContent = `${movie.genres}`
        console.log(movie.genres);

        console.log(movie);
        const popularity = document.createElement('p')
        popularity.textContent = `Popularidad: ${movie.popularity} / 100`

        const rating = document.createElement('p')
        if (movie.votes &amp;&amp; Array.isArray(movie.votes)) {
            const upvotes = movie.votes.filter((vote) => vote )
            const result = ((upvotes.length / movie.votes.length) * 10)
            rating.textContent = `Puntuación: ${result ? result.toFixed(2) : 0}`
        } else {
            rating.textContent = `Puntuación: 0`
        }
        
        const simImg = document.createElement('div')
        simImg.className = 'simulatedImg'
        simImg.style= `background-image: url('${await getMovieImage(movie.title)}')`
        
        const moreInfoButton = document.createElement('img')
        moreInfoButton.className = 'moreInfoImg'
        moreInfoButton.addEventListener('mouseenter', () => { displayAllInfo(movie, true) })
        moreInfoButton.addEventListener('mouseleave', () => { displayAllInfo(movie, false) })
        moreInfoButton.src = '../../public/img/svg/info.svg'
        moreInfoButton.alt = 'More info'

        const dataParent = document.createElement('div')
        dataParent.className = 'dataParent'

        const movieDataContainer = document.createElement('div')
        movieDataContainer.className = 'movieDataContainer'
        
        const movieTitle = document.createElement('p')
        movieTitle.textContent = movie.title
        
        const movieReleaseDate = document.createElement('p')
        movieReleaseDate.textContent = movie.releaseDate
        
        const movieImgVotes = document.createElement('div')
        movieImgVotes.className = 'movieImgVotes'
        
        const upVote = document.createElement('img')
        upVote.addEventListener('click', () => {
            handleVoteRate(true, movie)
        })
        upVote.src = '../../public/img/svg/upVote.svg'
        upVote.alt = 'upVote'

        const downVote = document.createElement('img')
        downVote.addEventListener('click', () => {
            handleVoteRate(false, movie)
        })
        downVote.src = '../../public/img/svg/downVote.svg'
        downVote.alt = 'downVote'

        const removeMovie = document.createElement('button')
        removeMovie.className = 'removeMovie'
        removeMovie.addEventListener('click', () => {
            delMovie(movie.id)
        })
        const removeMovieImg = document.createElement('img')
        removeMovieImg.src = '../../public/img/svg/trash.svg'
        removeMovieImg.alt = 'Remove movie'
        removeMovie.appendChild(removeMovieImg)

        allInfo.append(nVotes, genres, rating, popularity)
        simImg.append(moreInfoButton, allInfo)
        movieImgVotes.append(upVote, downVote)

        movieDataContainer.append(movieTitle, movieReleaseDate)
        dataParent.append(movieDataContainer, movieImgVotes)

        contentParent.append(simImg, dataParent, removeMovie)
        return contentParent
    }

    const movies = movieService.getMovies()
    if (Array.isArray(movies)) {
        movies.forEach(async(movie) => {
            moviesContainer.appendChild(await createMovieElement(movie))
        })
    }
}

const init = () => {
    loadMovies()
}

init()</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="GenreEntity.html">GenreEntity</a></li><li><a href="GenreService.html">GenreService</a></li><li><a href="MovieEntity.html">MovieEntity</a></li><li><a href="MovieService.html">MovieService</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getMovieImage">getMovieImage</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#manageGenreSelector">manageGenreSelector</a></li><li><a href="global.html#manageMovieCreation">manageMovieCreation</a></li><li><a href="global.html#manageMovieGenreCreation">manageMovieGenreCreation</a></li><li><a href="global.html#printAvailableGenres">printAvailableGenres</a></li><li><a href="global.html#printGenreList">printGenreList</a></li><li><a href="global.html#removeOnClick">removeOnClick</a></li><li><a href="global.html#setUpRemoveAllButton">setUpRemoveAllButton</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sun Dec 07 2025 13:32:52 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
